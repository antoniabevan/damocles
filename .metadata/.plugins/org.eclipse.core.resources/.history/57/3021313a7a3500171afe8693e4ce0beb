module mcmc_handler

    use globals
    use class_line
    use class_freq_grid
    use class_grid
    use electron_scattering
    use input
    use initialise
    use vector_functions
    use class_packet
    use radiative_transfer
    use model_comparison
    use mcmc_sampler
    use driver

    implicit none

contains

    subroutine mcmc()

        !final parameter list to be explored: max velocity, min velocity, density gradient, dust mass
        !!current list: max velocity

        open(53,file='input/MCMC.in')
        read(53,*)
        read(53,*) param_space%n_points
        close(53)

        open(54,file='output/trace.out')

        do ii=1,param_space%n_points
            call run_damocles()
            write(54,*) dust_geometry%v_max,chi_sq
        end do

        close(54)

    end subroutine

end module mcmc_handler
